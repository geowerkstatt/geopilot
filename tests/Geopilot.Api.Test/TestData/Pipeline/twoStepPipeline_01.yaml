processes:
  - id: ili_validator
    implementation: Geopilot.Api.Pipeline.Process.IliValidatorProcess
    data_handling:
      input_mapping:
        ili_file: file
      output_mapping:
        error_log: error_log
        xtf_log: xtf_log
    default_config:
      profile:
      poll_interval: 500
  - id: zip_package_process
    implementation: Geopilot.Api.Pipeline.Process.ZipPackageProcess
    data_handling:
      output_mapping:
        zip_package: zip_package
    default_config:
        archive_file_name: myPersonalZipArchive
pipelines:
  - id: two_steps
    display_name:
      en: two steps pipeline
    parameters:
      upload_step: upload
      mapping:
        - file_extension: xtf
          attribute: ili_file
    steps:
      - id: validation
        display_name:
          en: ILI Validation
        process_id: ili_validator
        process_config_overwrites:
          profile: DEFAULT
        input:
          - from: upload
            take: ili_file
            as: file
        output:
          - take: error_log
            as: error_log
            action:
          - take: xtf_log
            as: xtf_log
            action:
              - DOWNLOAD
      - id: zip_package
        display_name:
          en: Zip Package
        process_id: zip_package_process
        process_config_overwrites:
        input:
          - from: validation
            take: error_log
            as: error_log
          - from: validation
            take: xtf_log
            as: xtf_log
          - from: upload
            take: ili_file
            as: ili_file
        output:
          - take: zip_package
            as: zip_package
            action:
              - DOWNLOAD
